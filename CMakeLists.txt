# æœ€ä½ç‰ˆæœ¬è¦æ±‚
cmake_minimum_required(VERSION 3.22)

# é¡¹ç›®åç§°å’Œç‰ˆæœ¬å·
project(Saturn VERSION 1.0)

# è®¾ç½® C++ æ ‡å‡†
set(CMAKE_CXX_STANDARD 20)  # ä½¿ç”¨ C++20 , partial ğŸ˜€
set(CMAKE_CXX_STANDARD_REQUIRED True)
find_package(yaml-cpp REQUIRED)

add_compile_options(-rdynamic)

# å¯ç”¨è°ƒè¯•ä¿¡æ¯
set(CMAKE_BUILD_TYPE Debug)
# æŒ‡å®šæºæ–‡ä»¶æ‰€åœ¨ç›®å½•
include_directories(${PROJECT_SOURCE_DIR}/saturn)

# add_executable(Saturn
#     saturn/log.cc
# )
# å¯ç”¨æµ‹è¯•
enable_testing()

# add_executable(test_log
#     tests/test_log.cc
#     saturn/config.cc
#     saturn/util.cc
#     saturn/log.cc
# )

# add_executable(test_util
#     tests/test_util.cc
#     saturn/util.cc
#     saturn/log.cc
#     saturn/config.cc
#     saturn/thread.cc
#     saturn/sem.cc
# ) 
# add_executable(test_fiber
#     tests/test_fiber.cc
#     saturn/util.cc
#     saturn/log.cc
#     saturn/config.cc
#     saturn/thread.cc
#     saturn/sem.cc
#     saturn/fiber.cc
# ) 
add_executable(test_scheduler
    tests/test_scheduler.cc
    saturn/scheduler.cc
    saturn/util.cc
    saturn/log.cc
    saturn/config.cc
    saturn/thread.cc
    saturn/sem.cc
    saturn/fiber.cc
) 
# add_executable(test_config
#     tests/test_config.cc
#     saturn/config.cc
#     saturn/log.cc
#     saturn/util.cc
# )

# add_executable(test_thread
#     tests/test_thread.cc
#     saturn/config.cc
#     saturn/log.cc
#     saturn/util.cc
#     saturn/thread.cc
#     saturn/sem.cc
# )
# target_link_libraries(test_log /usr/local/lib/libyaml-cpp.so)
target_link_libraries(test_scheduler /usr/local/lib/libyaml-cpp.so)
# target_link_libraries(test_config /usr/local/lib/libyaml-cpp.so)
# target_link_libraries(test_thread /usr/local/lib/libyaml-cpp.so)

# æ³¨å†Œæµ‹è¯•
# add_test(NAME TestLog COMMAND test_log)
# add_test(NAME TestUtil COMMAND test_util)
add_test(NAME TestConfig COMMAND test_config)
